<script>
/**
 * Runtime validation functions for HGNC WebApp
 * These can be called from browser console during development/testing
 */

window.AppValidator = {
    /**
     * Check if all critical DOM elements exist
     */
    checkCriticalElements: function() {
        const criticalElements = [
            'insights-view',
            'insights-team-performance-view',
            'insights-offensive-leaders-view',
            'insights-defensive-wall-view',
            'insights-player-analysis-view',
            'app-tab-nav',
            'loading-overlay'
        ];

        let missing = [];
        criticalElements.forEach(id => {
            if (!document.getElementById(id)) {
                missing.push('#' + id);
            }
        });

        if (missing.length > 0) {
            console.error('‚ùå Missing critical elements:', missing);
            return false;
        } else {
            console.log('‚úÖ All critical elements present');
            return true;
        }
    },

    /**
     * Check if all required functions are defined
     */
    checkCriticalFunctions: function() {
        const requiredFunctions = [
            'showView',
            'renderNewInsightsDashboard',
            'renderInsightsOffensiveLeaders',
            'renderInsightsDefensiveWall',
            'renderInsightsPlayerAnalysis',
            'updateAllStatsAndRender'
        ];

        let missing = [];
        requiredFunctions.forEach(funcName => {
            const func = window[funcName];
            if (typeof func !== 'function') {
                missing.push(funcName);
            }
        });

        if (missing.length > 0) {
            console.error('‚ùå Missing critical functions:', missing);
            return false;
        } else {
            console.log('‚úÖ All critical functions defined');
            return true;
        }
    },

    /**
     * Test navigation to insights views
     */
    testInsightsNavigation: function() {
        console.log('üß™ Testing insights navigation...');

        const views = [
            'insights-team-performance-view',
            'insights-offensive-leaders-view',
            'insights-defensive-wall-view',
            'insights-player-analysis-view'
        ];

        views.forEach(viewId => {
            try {
                // Check if view element exists
                const view = document.getElementById(viewId);
                if (!view) {
                    console.error(`‚ùå View ${viewId} not found`);
                    return;
                }

                // Check if view has dashboard container
                const dashboard = view.querySelector('.insights-dashboard');
                if (!dashboard) {
                    console.error(`‚ùå View ${viewId} missing .insights-dashboard`);
                    return;
                }

                console.log(`‚úÖ View ${viewId} structure OK`);
            } catch (e) {
                console.error(`‚ùå Error testing ${viewId}:`, e);
            }
        });
    },

    /**
     * Check data availability for rendering
     */
    checkDataAvailability: function() {
        console.log('üìä Checking data availability...');

        const checks = [
            { name: 'appState', value: window.appState },
            { name: 'currentTeam', value: window.appState?.currentTeam },
            { name: 'allTeamData', value: window.allTeamData },
            { name: 'calculatedSeasonStats', value: window.calculatedSeasonStats },
            { name: 'players', value: window.players },
            { name: 'games', value: window.games }
        ];

        checks.forEach(check => {
            if (check.value) {
                console.log(`‚úÖ ${check.name}: available`);
            } else {
                console.warn(`‚ö†Ô∏è  ${check.name}: not available`);
            }
        });
    },

    /**
     * Run all validation checks
     */
    runAllChecks: function() {
        console.log('üöÄ Running all validation checks...');
        console.log('=====================================');

        let allPassed = true;

        allPassed &= this.checkCriticalElements();
        allPassed &= this.checkCriticalFunctions();
        this.testInsightsNavigation();
        this.checkDataAvailability();

        console.log('=====================================');
        if (allPassed) {
            console.log('üéâ All critical checks passed!');
        } else {
            console.error('‚ùå Some critical checks failed!');
        }

        return allPassed;
    }
};

// Auto-run basic checks on page load
document.addEventListener('DOMContentLoaded', function() {
    // Delay to allow scripts to load
    setTimeout(function() {
        console.log('üîç Running automatic validation checks...');
        window.AppValidator.checkCriticalElements();
        window.AppValidator.checkCriticalFunctions();
    }, 1000);
});
</script>